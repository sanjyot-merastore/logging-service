{
  "mappings": {
    "properties": {
      // General Metadata
      "correlation-id": { "type": "keyword" },
      "txn-id": { "type": "keyword" },
      "trace-id": { "type": "keyword" },
      "span-id": { "type": "keyword" },
      "request-id": { "type": "keyword" },
      "parent-span-id": { "type": "keyword" },
      "tenant-id": { "type": "keyword" },
      "service-name": { "type": "keyword" },
      "environment": { "type": "keyword" },
      "host-name": { "type": "keyword" },
      "pod-name": { "type": "keyword" },
      "container-id": { "type": "keyword" },

      // Network & Client Details
      "server-ip": { "type": "ip" },
      "client-ip": { "type": "ip" },
      "user-agent": { "type": "text" },

      // HTTP Request Details
      "http-method": { "type": "keyword" },
      "request-url": { "type": "keyword" },
      "request-base-url": { "type": "keyword" },
      "request-path": { "type": "keyword" },
      "request-query-string": { "type": "text" },
      "request-body": { "type": "text" },
      "request-size-bytes": { "type": "long" },
      "request-timestamp": { "type": "date" },
      "request-protocol": { "type": "keyword" },

      // Request Headers
      "rq-header.ms-correlationId": { "type": "keyword" },
      "rq-header.ms-request-id": { "type": "keyword" },
      "rq-header.ms-txn-id": { "type": "keyword" },
      "rq-header.ms-traceid": { "type": "keyword" },
      "rq-header.ms-spanid": { "type": "keyword" },
      "rq-header.ms-parent-spanid": { "type": "keyword" },
      "rq-header.ms-requeststart": { "type": "date" },
      "rq-header.ms-servicename": { "type": "keyword" },
      "rq-header.ms-userid": { "type": "keyword" },
      "rq-header.ms-clientid": { "type": "keyword" },
      "rq-header.ms-sessionid": { "type": "keyword" },
      "rq-header.ms-tenantid": { "type": "keyword" },
      "rq-header.ms-roles": { "type": "keyword" },
      "rq-header.ms-scope": { "type": "keyword" },
      "rq-header.ms-auth-method": { "type": "keyword" },
      "rq-header.ms-deviceid": { "type": "keyword" },
      "rq-header.ms-appversion": { "type": "keyword" },
      "rq-header.ms-region": { "type": "keyword" },
      "rq-header.ms-environment": { "type": "keyword" },
      "rq-header.ms-apiversion": { "type": "keyword" },
      "rq-header.ms-feature-flag": { "type": "keyword" },
      "rq-header.ms-debug-mode": { "type": "boolean" },
      "rq-header.user-agent": { "type": "text" },
      "rq-header.authorization": { "type": "text" },
      "rq-header.content-type": { "type": "keyword" },
      "rq-header.accept": { "type": "keyword" },
      "rq-header.accept-encoding": { "type": "keyword" },
      "rq-header.accept-language": { "type": "keyword" },
      "rq-header.host": { "type": "keyword" },
      "rq-header.referer": { "type": "text" },
      "rq-header.origin": { "type": "keyword" },
      "rq-header.connection": { "type": "keyword" },
      "rq-header.cache-control": { "type": "keyword" },
      "rq-header.pragma": { "type": "keyword" },
      "rq-header.x-forwarded-for": { "type": "ip" },
      "rq-header.x-forwarded-proto": { "type": "keyword" },
      "rq-header.x-forwarded-port": { "type": "integer" },
      "rq-header.x-request-id": { "type": "keyword" },
      "rq-header.x-real-ip": { "type": "ip" },
      "rq-header.x-api-key": { "type": "keyword" },
      "rq-header.if-modified-since": { "type": "date" },
      "rq-header.if-none-match": { "type": "keyword" },
      "rq-header.range": { "type": "keyword" },

      // HTTP Response Details
      "status-code": { "type": "integer" },
      "response": { "type": "keyword" },
      "request": { "type": "keyword" },
      "response-size-bytes": { "type": "long" },
      "time-taken-ms": { "type": "double" },
      "response-timestamp": { "type": "date" },

      // Response Headers
      "rs-header.ms-correlationId": { "type": "keyword" },
      "rs-header.ms-request-id": { "type": "keyword" },
      "rs-header.ms-txn-id": { "type": "keyword" },
      "rs-header.ms-requestid": { "type": "keyword" },
      "rs-header.ms-traceid": { "type": "keyword" },
      "rs-header.ms-spanid": { "type": "keyword" },
      "rs-header.ms-servicename": { "type": "keyword" },
      "rs-header.content-type": { "type": "keyword" },
      "rs-header.content-length": { "type": "long" },
      "rs-header.server": { "type": "keyword" },
      "rs-header.connection": { "type": "keyword" },
      "rs-header.cache-control": { "type": "keyword" },
      "rs-header.pragma": { "type": "keyword" },
      "rs-header.set-cookie": { "type": "text" },
      "rs-header.expires": { "type": "date" },
      "rs-header.last-modified": { "type": "date" },
      "rs-header.etag": { "type": "keyword" },
      "rs-header.x-powered-by": { "type": "keyword" },
      "rs-header.access-control-allow-origin": { "type": "keyword" },
      "rs-header.access-control-allow-credentials": { "type": "boolean" },
      "rs-header.access-control-allow-methods": { "type": "keyword" },
      "rs-header.access-control-allow-headers": { "type": "keyword" },
      "rs-header.x-frame-options": { "type": "keyword" },
      "rs-header.x-xss-protection": { "type": "keyword" },
      "rs-header.x-content-type-options": { "type": "keyword" },
      "rs-header.strict-transport-security": { "type": "keyword" },
      "rs-header.referrer-policy": { "type": "keyword" },
      "rs-header.feature-policy": { "type": "keyword" },
      "rs-header.content-security-policy": { "type": "text" },

      // Query String Parameters
      "querystring.transaction-id": { "type": "keyword" },
      "querystring.page-number": { "type": "integer" },
      "querystring.page-size": { "type": "integer" },
      "querystring.sort-by": { "type": "keyword" },
      "querystring.sort-order": { "type": "keyword" },
      "querystring.filter": { "type": "text" },
      "querystring.search": { "type": "text" },
      "querystring.locale": { "type": "keyword" },
      "querystring.currency": { "type": "keyword" },
      "querystring.country": { "type": "keyword" },
      "querystring.category": { "type": "keyword" },
      "querystring.item-id": { "type": "keyword" },
      "querystring.session-id": { "type": "keyword" },
      "querystring.user-id": { "type": "keyword" },

      // Performance Metrics
      "db-query-time-ms": { "type": "long" },
      "external-api-time-ms": { "type": "long" },
      "cache-lookup-time-ms": { "type": "long" },

      // Exception Logging
      "ex-message": { "type": "text" },
      "exception": { "type": "text" },
      "inner-exception": { "type": "text" },
      "ex-stack-trace": { "type": "text" },
      "ex-type": { "type": "keyword" },
      "ex-details": { "type": "text" },
      "is-handled-exception": { "type": "boolean" },

      // Event & DDD Logs
      "event-type": { "type": "keyword" },
      "event-source": { "type": "keyword" },
      "event-id": { "type": "keyword" },
      "event-correlation-id": { "type": "keyword" },
      "saga-id": { "type": "keyword" },
      "aggregate-id": { "type": "keyword" },
      "aggregate-type": { "type": "keyword" },
      "command-name": { "type": "keyword" },
      "command-payload": { "type": "text" },
      "event-payload": { "type": "text" },
      "event-timestamp": { "type": "date" },
      // 💡 Advanced observability
      "event-version": { "type": "keyword" },
      "event-retry-count": { "type": "integer" },
      "event-handler-name": { "type": "keyword" },
      "event-consumer-group": { "type": "keyword" },
      "event-offset": { "type": "long" },
      "event-partition": { "type": "integer" },
      "event-topic": { "type": "keyword" },
      "event-ingest-timestamp": { "type": "date" },
      "event-publish-timestamp": { "type": "date" },

      // 🧠 Optional metadata for versioning, categorization
      "event-category": { "type": "keyword" },
      "event-priority": { "type": "keyword" },
      "event-stream-id": { "type": "keyword" },
      "is-replay": { "type": "boolean" },
      "is-compensating-action": { "type": "boolean" },

      // User & Session Data
      "user-id": { "type": "keyword" },
      "session-id": { "type": "keyword" },
      "device-id": { "type": "keyword" },
      "geo-location": { "type": "keyword" },
      "feature-flag": { "type": "keyword" },
      "experiment-group": { "type": "keyword" },
      "authentication-type": { "type": "keyword" },
      "authorization-status": { "type": "keyword" },
      "sensitive-data-redacted": { "type": "boolean" },

      // E-Commerce Specific Data
      "product-id": { "type": "keyword" },
      "product-sku": { "type": "keyword" },
      "product-name": { "type": "text" },
      "product-category": { "type": "keyword" },
      "product-price": { "type": "double" },
      "product-availability": { "type": "boolean" },
      "product-discount": { "type": "double" },
      "cart-id": { "type": "keyword" },
      "cart-total-items": { "type": "integer" },
      "cart-total-price": { "type": "double" },
      "cart-currency": { "type": "keyword" },
      "cart-discount": { "type": "double" },
      "inventory-id": { "type": "keyword" },
      "warehouse-id": { "type": "keyword" },
      "stock-level": { "type": "integer" },
      "reorder-threshold": { "type": "integer" },
      "restock-date": { "type": "date" },

      // Order & Payment
      "order-id": { "type": "keyword" },
      "order-status": { "type": "keyword" },
      "order-total-price": { "type": "double" },
      "order-currency": { "type": "keyword" },
      "order-payment-status": { "type": "keyword" },
      "order-shipping-method": { "type": "keyword" },
      "order-delivery-estimate": { "type": "date" },
      "payment-id": { "type": "keyword" },
      "payment-status": { "type": "keyword" },
      "payment-method": { "type": "keyword" },
      "transaction-id": { "type": "keyword" },
      "payment-currency": { "type": "keyword" },
      "payment-amount": { "type": "double" },

      // Authentication & Security
      "auth-user-id": { "type": "keyword" },
      "auth-token": { "type": "keyword" },
      "auth-role": { "type": "keyword" },
      "auth-permissions": { "type": "text" },
      "auth-client-id": { "type": "keyword" }, // OAuth2 or app ID
      "auth-session-id": { "type": "keyword" }, // Track per-login session
      "auth-method": { "type": "keyword" }, // e.g., password, OTP, SSO, biometric
      "auth-scope": { "type": "keyword" }, // OAuth2 scopes
      "auth-issuer": { "type": "keyword" }, // JWT issuer
      "auth-expiry": { "type": "date" }, // Token expiry time
      "auth-issued-at": { "type": "date" }, // Token iat
      "auth-is-refresh": { "type": "boolean" }, // Is this a refresh token
      "auth-token-type": { "type": "keyword" }, // Bearer, JWT, etc.
      "auth-audience": { "type": "keyword" }, // Token audience (aud claim)
      "auth-tenant-id": { "type": "keyword" }, // For multi-tenant segregation
      "auth-device-id": { "type": "keyword" }, // For tracking auth from specific device
      "auth-region": { "type": "keyword" }, // Region the user authenticated from


      // Notifications
      "notification-id": { "type": "keyword" },
      "notification-type": { "type": "keyword" },
      "notification-status": { "type": "keyword" },
      "notification-recipient": { "type": "keyword" },

      // Analytics & Search
      "search-query": { "type": "text" },
      "search-results-count": { "type": "integer" },
      "search-execution-time-ms": { "type": "long" },
      "analytics-event": { "type": "keyword" },
      "analytics-timestamp": { "type": "date" },
      "analytics-value": {
        "type": "double"
      },


      // Logging Service
      "log-id": { "type": "keyword" },
      "log-level": { "type": "keyword" },
      "log-source": { "type": "keyword" },
      "log-correlation-id": { "type": "keyword" },
      "log-retention": { "type": "integer" },
      "log-category": { "type": "keyword" },

      // Review Service
      "review-id": { "type": "keyword" },
      "review-rating": { "type": "double" },
      "review-comments": { "type": "text" },
      "review-moderation-status": { "type": "keyword" },
      "review-user-id": { "type": "keyword" },
      "review-product-id": { "type": "keyword" },

      // Analytics Service
      "analytics-event-id": { "type": "keyword" },
      "analytics-event-type": { "type": "keyword" },
      "analytics-event-properties": { "type": "text" },
      "analytics-metric-name": { "type": "keyword" },
      "analytics-metric-value": { "type": "double" },
      "analytics-aggregation-type": { "type": "keyword" },
      "analytics-user-id": { "type": "keyword" },

      // Fraud Detection Service
      "fraud-detection-id": { "type": "keyword" },
      "fraud-risk-score": { "type": "double" },
      "fraud-alert-flag": { "type": "boolean" },
      "fraud-reason": { "type": "text" },
      "transaction-anomaly-details": { "type": "text" },
      "fraud-user-id": { "type": "keyword" },
      "fraud-payment-id": { "type": "keyword" },

      // Notification Service
      "notification-delivery-status": { "type": "keyword" },
      "notification-recipient-id": { "type": "keyword" },
      "notification-template": { "type": "text" },
      "notification-timestamp": { "type": "date" },

      // Payment Service
      "payment-gateway-id": { "type": "keyword" },
      "transaction-reference": { "type": "keyword" },
      "chargeback-status": { "type": "keyword" },
      "settlement-time": { "type": "date" },
      "payment-user-id": { "type": "keyword" },
      "payment-order-id": { "type": "keyword" },

      // Inventory Service

      "stock-allocation-status": { "type": "keyword" },

      "warehouse-location": { "type": "keyword" },
      "safety-stock-level": { "type": "integer" },
      "backorder-status": { "type": "keyword" },
      "stock-item-id": { "type": "keyword" },

      // Discount Service
      "discount-id": { "type": "keyword" },
      "discount-type": { "type": "keyword" },
      "discount-eligibility": { "type": "keyword" },
      "discount-usage-count": { "type": "integer" },
      "discount-tier": { "type": "keyword" },
      "discount-product-id": { "type": "keyword" },

      // Cart Service

      "cart-expiration-time": { "type": "date" },
      "cart-item-count": { "type": "integer" },

      "applied-coupons": { "type": "text" },
      "cart-user-id": { "type": "keyword" },

      // Order Service

      "order-fulfillment-status": { "type": "keyword" },
      "shipping-provider": { "type": "keyword" },
      "estimated-delivery-date": { "type": "date" },
      "order-tracking-id": { "type": "keyword" },
      "order-user-id": { "type": "keyword" },
      "order-payment-id": { "type": "keyword" },

      // Product Service

      "product-variant-id": { "type": "keyword" },
      "product-specifications": { "type": "text" },
      "product-warranty": { "type": "text" },
      "product-tags": { "type": "text" },

      // User Service

      "user-preferences": { "type": "text" },
      "subscription-tier": { "type": "keyword" },
      "status": { "type": "keyword" },
      "last-login-timestamp": { "type": "date" },
      "user-verification-status": { "type": "keyword" },
      "user-session-id": { "type": "keyword" },
      "user-device-id": {
        "type": "keyword"
      },
      "event-processing-time-ms": { "type": "long" },
      "workflow-id": { "type": "keyword" },
      "workflow-name": { "type": "keyword" },
      "workflow-step-name": { "type": "keyword" },
      "workflow-step-sequence": { "type": "integer" },
      "workflow-status": { "type": "keyword" },
      "workflow-start-timestamp": { "type": "date" },
      "workflow-end-timestamp": { "type": "date" },
      "workflow-duration-ms": { "type": "long" },
      "workflow-error-message": { "type": "text" },
      "workflow-error-stack": { "type": "text" },
      "workflow-retry-count": { "type": "integer" },
      "workflow-trigger-source": { "type": "keyword" },
      "workflow-input-payload": { "type": "text" },
      "workflow-output-payload": { "type": "text" },
      "pipeline-name": { "type": "keyword" },
      "pipeline-duration-ms": { "type": "long" },
      "pipeline-failure-step-name": { "type": "keyword" },
      "pipeline-recovery-action": { "type": "keyword" },
      "pipeline-behavior-duration": { "type": "long" },

      "request-referer": { "type": "keyword" },
      "request-caller": { "type": "keyword" },
      "request-client-timestamp": { "type": "date" },
      "request-content-encoding": { "type": "keyword" },
      "request-accept-language": { "type": "keyword" },
      "request-correlation-id": { "type": "keyword" },
      "request-cookie": { "type": "text" },
      "request-protocol-version": { "type": "keyword" },
      "request-endpoint-category": { "type": "keyword" },

      "response-status-message": { "type": "keyword" },
      "response-content-encoding": { "type": "keyword" },
      "response-cache-status": { "type": "keyword" },
      "response-time-to-first-byte-ms": { "type": "long" },
      "response-trailer-headers": { "type": "text" },
      "response-set-cookie": { "type": "text" },
      "response-transfer-encoding": { "type": "keyword" },

      "round-trip-time-ms": { "type": "long" },
      "request-response-size-delta": { "type": "long" }
    }
  }
}
